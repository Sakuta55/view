<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·</title>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Arial', sans-serif; }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #3498db;
        }
        
        .header h1 {
            font-size: 32px;
            color: #3498db;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(52, 152, 219, 0.3);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #3498db;
        }
        
        .stat-value {
            font-size: 48px;
            font-weight: bold;
            color: #2ecc71;
            margin: 10px 0;
        }
        
        .notes-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }
        
        .note-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #3498db;
            transition: all 0.3s;
        }
        
        .note-card:hover {
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .note-title {
            font-size: 20px;
            font-weight: bold;
            color: #ecf0f1;
        }
        
        .note-id {
            font-size: 12px;
            color: #95a5a6;
            background: rgba(0, 0, 0, 0.3);
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        .note-content {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .note-footer {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #bdc3c7;
            margin-top: 15px;
        }
        
        .code-indicator {
            color: #f1c40f;
            font-weight: bold;
        }
        
        .last-update {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #95a5a6;
            font-size: 14px;
        }
        
        .auto-refresh {
            background: rgba(46, 204, 113, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            border: 1px solid rgba(46, 204, 113, 0.4);
        }
        
        @media (max-width: 768px) {
            .notes-container {
                grid-template-columns: 1fr;
            }
            
            .stat-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h1>
            <p>Ø¹Ø±Ø¶ Ø­ÙŠ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª - ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©</p>
        </div>
        
        <div class="stats-grid" id="statsGrid">
            <!-- Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‡Ù†Ø§ -->
        </div>
        
        <div id="notesContainer" class="notes-container">
            <!-- Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù‡Ù†Ø§ -->
        </div>
        
        <div class="auto-refresh">
            ğŸ”„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…ÙØ¹Ù‘Ù„ - ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
        </div>
        
        <div class="last-update" id="lastUpdate">
            Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: --
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <script>
        // âš ï¸ Ø¨ÙŠØ§Ù†Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
        const firebaseConfig = {
            apiKey: "AIzaSyDzmBBnFmLHe2L-H4BbmlM8krkTWHIOG0c",
            authDomain: "mynotesapp-83195.firebaseapp.com",
            projectId: "mynotesapp-83195",
            storageBucket: "mynotesapp-83195.firebasestorage.app",
            messagingSenderId: "983612900174",
            appId: "1:983612900174:web:489c457a7ee857f8ced41f",
            measurementId: "G-7BJMMJ3PJG"
        };
        
        // ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        async function updateDashboard() {
            try {
                const snapshot = await db.collection('notes')
                    .orderBy('updatedAt', 'desc')
                    .get();
                
                const notes = [];
                let totalCodes = 0;
                
                snapshot.forEach(doc => {
                    const note = {
                        id: doc.id,
                        ...doc.data()
                    };
                    notes.push(note);
                    
                    // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
                    const codeBlocks = (note.content || '').match(/```[\s\S]*?```/g);
                    if (codeBlocks) totalCodes += codeBlocks.length;
                });
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                document.getElementById('statsGrid').innerHTML = `
                    <div class="stat-card">
                        <div>ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
                        <div class="stat-value">${snapshot.size}</div>
                        <div>Ù…Ù„Ø§Ø­Ø¸Ø©</div>
                    </div>
                    <div class="stat-card">
                        <div>ğŸ’» Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</div>
                        <div class="stat-value">${totalCodes}</div>
                        <div>ÙƒÙˆØ¯</div>
                    </div>
                    <div class="stat-card">
                        <div>ğŸ•’ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</div>
                        <div class="stat-value">${notes.length > 0 ? 
                            new Date(notes[0].updatedAt?.toDate?.() || Date.now()).toLocaleTimeString('ar-EG', {hour: '2-digit', minute:'2-digit'}) : 
                            '--'}</div>
                        <div>Ø¢Ø®Ø± Ù…Ù„Ø§Ø­Ø¸Ø©</div>
                    </div>
                    <div class="stat-card">
                        <div>ğŸ“Š Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                        <div class="stat-value">${notes.reduce((acc, note) => acc + (note.content?.length || 0), 0)}</div>
                        <div>Ø­Ø±Ù</div>
                    </div>
                `;
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
                let notesHTML = '';
                notes.forEach((note, index) => {
                    const hasCode = note.content && note.content.includes('```');
                    const date = note.updatedAt ? 
                        new Date(note.updatedAt.toDate()).toLocaleString('ar-EG') : 
                        'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    
                    notesHTML += `
                        <div class="note-card">
                            <div class="note-header">
                                <div class="note-title">${note.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</div>
                                <div class="note-id">#${index + 1}</div>
                            </div>
                            
                            <div class="note-content">
                                ${note.content || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰'}
                            </div>
                            
                            <div class="note-footer">
                                <div>
                                    ${hasCode ? '<span class="code-indicator">âš¡ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£ÙƒÙˆØ§Ø¯</span>' : 'ğŸ“„ Ù†Øµ ÙÙ‚Ø·'}
                                </div>
                                <div>
                                    ğŸ“… ${date}
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                document.getElementById('notesContainer').innerHTML = notesHTML;
                document.getElementById('lastUpdate').innerHTML = 
                    `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${new Date().toLocaleString('ar-EG')}`;
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„:', error);
                document.getElementById('notesContainer').innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: #e74c3c;">
                        <h2>âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
        updateDashboard();
        
        // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
        setInterval(updateDashboard, 30000);
        
        // ØªØ­Ø¯ÙŠØ« ÙŠØ¯ÙˆÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'DIV' && e.target.classList.contains('dashboard')) {
                updateDashboard();
            }
        });
    </script>
</body>
</html>