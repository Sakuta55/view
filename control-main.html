<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - MCS</title>
    <link rel="stylesheet" href="control-style.css">
    <style>
        .user-header {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #ffd700;
        }
        .user-details h3 {
            margin: 0;
            color: #ffd700;
            font-size: 1.3rem;
        }
        .user-details p {
            margin: 5px 0 0;
            opacity: 0.8;
        }
        .permission-badge {
            display: inline-block;
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin: 2px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        .control-card.disabled {
            opacity: 0.5;
            pointer-events: none;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- Ø²Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ -->
    <button class="logout-btn" onclick="logout()">Ø®Ø±ÙˆØ¬</button>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="control-container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header class="control-header">
            <div class="user-header">
                <img id="userAvatar" class="user-avatar" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                <div class="user-details">
                    <h3 id="userName"></h3>
                    <p id="userEmail"></p>
                    <div id="userPermissions"></div>
                </div>
            </div>
            <h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… MCS</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­ØªÙˆÙ‰ Ù…ÙˆÙ‚Ø¹ Ù…Ø§ÙŠÙ†ÙƒØ±Ø§ÙØª Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</p>
        </header>
        
        <a href="https://boisterous-sunflower-2eb76d.netlify.app/">
            <img src="site.png" alt="Ø²Ø± Ø¹Ø§Ø¦Ù…" class="floating-btn">
        </a>
        
        

        <!-- Ø´Ø¨ÙƒØ© Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="control-grid" id="controlGrid">
            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
        </div>
    </div>

    <script src="control-main-script.js"></script>
    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        const user = JSON.parse(localStorage.getItem('mcs_user'));
        const isLoggedIn = localStorage.getItem('controlLoggedIn');
        
        if (!user || !isLoggedIn) {
            window.location.href = 'index.html';
            throw new Error('ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„');
        }
        
        // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        document.getElementById('userName').textContent = user.name;
        document.getElementById('userEmail').textContent = user.email;
        document.getElementById('userAvatar').src = user.photoURL || 'https://lh3.googleusercontent.com/a/ACg8ocIwrmQ4ZyLhsN0_5rdXUPR-TyQrVexf1h8jwHOzbgVDYhHUYA=s96-c';
        
                // Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡
        // Ø¹Ø±Ø¶ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
        const permissionsDiv = document.getElementById('userPermissions');
        const permissions = user.permissions || [];
        
        if (permissions.includes('Ø§Ù„Ù…Ø¤Ø³Ø³')) {
            permissionsDiv.innerHTML = '<span class="permission-badge" style="background: rgba(255,0,0,0.2); color: #ff6b6b; border-color: rgba(255,0,0,0.3);">Ø§Ù„Ù…Ø¤Ø³Ø³</span>';
        } else if (permissions.length > 0) {
            permissionsDiv.innerHTML += `<span class="permission-badge">Ù…Ø³Ø¤ÙˆÙ„</span>`;
        }
        
        
        
        // ØªØ¹Ø±ÙŠÙ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ÙƒÙ„ Ù‚Ø³Ù…
        const sectionPermissions = {
            'popup': 'Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø³Ù‚Ù‡',
            'news': 'Ø§Ù„Ø§Ø®Ø¨Ø§Ø±',
            'download': 'Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„',
            'mods': 'Ø§Ù„Ù…ÙˆØ¯Ø§Øª',
            'send-coins': 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆÙŠÙ†',
            'reward-coins': 'Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ÙƒÙˆÙŠÙ†',
            'add-admin': 'Ø¥Ø¶Ø§ÙØ© Ø§Ø¯Ù…Ù†',
            'remove-admin': 'Ø¥Ø²Ø§Ù„Ø© Ø§Ø¯Ù…Ù†'
        };
        
        // Ø¹Ø±Ø¶ Ø£Ø²Ø±Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
        const controlGrid = document.getElementById('controlGrid');
        const sections = [
            {
                id: 'popup',
                icon: 'ğŸªŸ',
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©',
                description: 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Øµ ÙˆØ§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ø­Ø§Ù„Ø© Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ',
                url: 'control-popup.html'
            },
            {
                id: 'news',
                icon: 'ğŸ“°',
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø¨Ø§Ø±',
                description: 'Ø¥Ø¶Ø§ÙØ©ØŒ ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø£Ø®Ø¨Ø§Ø±',
                url: 'control-news.html'
            },
            {
                id: 'download',
                icon: 'ğŸ“¦',
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„',
                description: 'Ø¥Ø¶Ø§ÙØ©ØŒ ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø©',
                url: 'control-download.html'
            },
            {
                id: 'mods',
                icon: 'ğŸ®',
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Øª',
                description: 'Ø¥Ø¶Ø§ÙØ©ØŒ ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ù…ÙˆØ¯Ø§Øª Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª',
                url: 'control-mods.html'
            },
            {
                id: 'send-coins',
                icon: '<div class="logo"><img src="coin.png" class="logo"></div>',
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙˆÙŠÙ†Ø²',
                description: 'Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆÙŠÙ† Ù…ÙƒØ³ Ø¥Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ğŸ‘¥',
                url: 'control-send-coins.html'
            },
            {
                id: 'reward-coins',
                icon: '<div class="logo"><img src="coin.png" class="logo"></div>',
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²',
                description: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙˆÙŠÙ† Ø§Ù„ØªÙŠ ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø®Ù„Ø§Ù„ ÙØªØ±Ø© Ù…Ø¹ÙŠÙ†Ù‡ ğŸ•ğŸª™',
                url: 'control-setting-get-coin.html'
            }
        ];
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
        sections.forEach(section => {
            const hasPermission = permissions.includes('Ø§Ù„Ù…Ø¤Ø³Ø³') || 
                                permissions.includes(sectionPermissions[section.id]);
            
            const card = document.createElement('a');
            card.href = hasPermission ? section.url : '#';
            card.className = `control-card ${!hasPermission ? 'disabled' : ''}`;
            card.innerHTML = `
                <div class="control-icon">${section.icon}</div>
                <h2>${section.title}</h2>
                <p>${section.description}</p>
            `;
            
            controlGrid.appendChild(card);
        });
        
        // Ø¹Ø±Ø¶ Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙ‡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
        const hasAddAdminPermission = permissions.includes('Ø§Ù„Ù…Ø¤Ø³Ø³') || 
                                    permissions.includes('Ø¥Ø¶Ø§ÙØ© Ø§Ø¯Ù…Ù†');
        
        if (hasAddAdminPermission) {
            document.getElementById('addAdminBtn').style.display = 'flex';
            
            // Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
            const adminSection = document.createElement('a');
            adminSection.href = 'view-admins.html';
            adminSection.className = 'control-card';
            adminSection.innerHTML = `
                <div class="control-icon">ğŸ‘¥</div>
                <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</h2>
                <p>Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ù†Ø¸Ø§Ù…</p>
            `;
            controlGrid.appendChild(adminSection);
        }
        
        function logout() {
            localStorage.removeItem('controlLoggedIn');
            localStorage.removeItem('loginTime');
            localStorage.removeItem('mcs_user');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>